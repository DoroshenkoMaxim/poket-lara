# –ü–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ PocketOption

–°–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π PocketOption —Å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –ø–æ—Å—Ç–±–µ–∫–æ–≤ –∏ —Ç–µ–ª–µ–≥—Ä–∞–º-–±–æ—Ç–æ–º.

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏

- üîó –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ click_id
- üì® –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å—Ç–±–µ–∫–æ–≤ –æ—Ç PocketPartners (–Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç —Å –º–∞–∫—Ä–æ—Å–∞–º–∏)
- üéØ –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Ç–æ—Ä–≥–æ–≤—ã–º–∏ —Å–∏–≥–Ω–∞–ª–∞–º–∏ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –¥–æ—Å—Ç—É–ø–∞
- üìù JSON —Ñ–∞–π–ª–æ–≤–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –ø—Ä–æ—Å—Ç–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- üîí –°–∏—Å—Ç–µ–º–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
POKET/
‚îú‚îÄ‚îÄ composer.json          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ PHP
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îî‚îÄ‚îÄ Database.php      # –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
‚îú‚îÄ‚îÄ public/
‚îÇ   ‚îú‚îÄ‚îÄ .htaccess         # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ Apache
‚îÇ   ‚îú‚îÄ‚îÄ generate_link.php # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–∏—Ö —Å—Å—ã–ª–æ–∫
‚îÇ   ‚îú‚îÄ‚îÄ postback.php      # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å—Ç–±–µ–∫–æ–≤
‚îÇ   ‚îú‚îÄ‚îÄ generate_signals_link.php # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Å—ã–ª–æ–∫ –Ω–∞ —Å–∏–≥–Ω–∞–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ signals.php       # –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å —Å–∏–≥–Ω–∞–ª–∞–º–∏
‚îú‚îÄ‚îÄ data/                 # SQLite –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ logs/                 # –õ–æ–≥–∏ —Å–∏—Å—Ç–µ–º—ã
‚îî‚îÄ‚îÄ README.md
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
composer install
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:
```bash
chmod 755 data/ logs/
chmod 644 data/*.json logs/postback.log
```

3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã:
```bash
php test.php
```

## API Endpoints

### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–π —Å—Å—ã–ª–∫–∏
**GET** `/generate_link.php?telegram_id=123456`

–û—Ç–≤–µ—Ç:
```json
{
    "success": true,
    "click_id": "click_123456_...",
    "affiliate_link": "https://u3.shortink.io/register?...",
    "telegram_id": "123456"
}
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ—Å—Ç–±–µ–∫–∞
**POST** `/postback.php`

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã (–Ω–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç PocketPartners):
- `click_id` - ID –∫–ª–∏–∫–∞
- `trader_id` - ID —Ç—Ä–µ–π–¥–µ—Ä–∞
- `country` - –°—Ç—Ä–∞–Ω–∞
- `promo` - –ü—Ä–æ–º–æ–∫–æ–¥
- `device_type` - –¢–∏–ø —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
- `event` - –¢–∏–ø —Å–æ–±—ã—Ç–∏—è (reg, conf, ftd, dep)

### 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–∏–≥–Ω–∞–ª—ã
**GET** `/generate_signals_link.php?click_id=xxx&trader_id=yyy`

### 4. –°—Ç—Ä–∞–Ω–∏—Ü–∞ —Å–∏–≥–Ω–∞–ª–æ–≤
**GET** `/signals.php?click_id=xxx&trader_id=yyy&telegram_id=zzz`

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Å—Ç–±–µ–∫–∞ –≤ PocketPartners

1. URL –ø–æ—Å—Ç–±–µ–∫–∞: `https://yourdomain.com/postback.php`
2. –ú–µ—Ç–æ–¥: `POST`
3. –°–æ–±—ã—Ç–∏–µ: `Trader has registered`
4. URL —Å –º–∞–∫—Ä–æ—Å–∞–º–∏:
```
https://yourdomain.com/postback.php?event=reg&click_id={click_id}&trader_id={trader_id}&country={country}&promo={promo}&device_type={device_type}
```

## –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã

1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Å—ã–ª–∫–∏**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫—É—é —Å—Å—ã–ª–∫—É —á–µ—Ä–µ–∑ telegram_id
2. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è –Ω–∞ PocketOption
3. **–ü–æ—Å—Ç–±–µ–∫**: PocketPartners –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ—Å—Ç–±–µ–∫ —Å –¥–∞–Ω–Ω—ã–º–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
4. **–°–≤—è–∑—ã–≤–∞–Ω–∏–µ**: –°–∏—Å—Ç–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–≤—è–∑–∫—É click_id ‚Üí trader_id
5. **–î–æ—Å—Ç—É–ø –∫ —Å–∏–≥–Ω–∞–ª–∞–º**: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ç–æ—Ä–≥–æ–≤—ã–º —Å–∏–≥–Ω–∞–ª–∞–º

## –•—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö (JSON —Ñ–∞–π–ª—ã)

### –§–∞–π–ª `data/affiliate_links.json`
```json
[
  {
    "id": 1,
    "click_id": "click_123456_unique_id",
    "telegram_id": 123456789,
    "created_at": "2024-01-01 12:00:00"
  }
]
```

### –§–∞–π–ª `data/registrations.json`
```json
[
  {
    "id": 1,
    "click_id": "click_123456_unique_id",
    "trader_id": "TR_12345678",
    "country": "RU",
    "promo": "WELCOME50",
    "device_type": "desktop",
    "created_at": "2024-01-01 12:05:00"
  }
]
```

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏ –∑–∞—â–∏—â–µ–Ω—ã —á–µ—Ä–µ–∑ prepared statements
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ—Å—Ç–±–µ–∫–æ–≤ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
- CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –∫—Ä–æ—Å—Å–¥–æ–º–µ–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ —Å–ª—É–∂–µ–±–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–í—Å–µ –ø–æ—Å—Ç–±–µ–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ `logs/postback.log` –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –æ—Ç–ª–∞–¥–∫–∏.

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- PHP 8.4+
- ext-json
- Apache —Å mod_rewrite
- Composer

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏:

```bash
php test.php
```

–ü—Ä–∏–º–µ—Ä —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —á–µ—Ä–µ–∑ HTTP:

```bash
# 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä—Ç–Ω–µ—Ä—Å–∫–æ–π —Å—Å—ã–ª–∫–∏
curl "http://localhost/generate_link.php?telegram_id=123456789"

# 2. –ò–º–∏—Ç–∞—Ü–∏—è –ø–æ—Å—Ç–±–µ–∫–∞
curl -X POST "http://localhost/postback.php" \
  -d "click_id=click_123456_unique_id&trader_id=TR_12345678&country=RU&promo=WELCOME50&device_type=desktop&event=reg"

# 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å—Å—ã–ª–∫–∏ –Ω–∞ —Å–∏–≥–Ω–∞–ª—ã
curl "http://localhost/generate_signals_link.php?click_id=click_123456_unique_id&trader_id=TR_12345678"

# 4. –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–∏–≥–Ω–∞–ª–æ–≤
curl "http://localhost/signals.php?click_id=click_123456_unique_id&trader_id=TR_12345678"
``` 